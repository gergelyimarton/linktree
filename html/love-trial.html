<!doctype html>
<html lang="hu">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Love Trial</title>
  <link rel="icon" href="../images/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="../CSS/love-trial.css">

  
</head>
<body>
  <div class="floating-hearts">
    <span class="heart heart-1">â¤ï¸</span>
    <span class="heart heart-2">ğŸ’–</span>
    <span class="heart heart-3">ğŸ’•</span>
    <span class="heart heart-4">ğŸ’—</span>
    <span class="heart heart-5">ğŸ’˜</span>
    <span class="heart heart-6">ğŸ’</span>
    <span class="heart heart-7">ğŸ’</span>
    <span class="heart heart-8">ğŸ’“</span>
    <span class="heart heart-9">ğŸ©·</span>
  </div>
  <div class="body-container">
  <h1>Love Trial</h1>

  <h2 data-emoji="ğŸ’">FÅ‘ aspektusok</h2>
  <table id="mainAspects">
    <thead>
      <tr><th>FÅ‘ aspektus</th><th>1. randi</th><th>2. randi</th><th>3. randi</th><th>4. randi</th><th>5. randi</th><th>PontszÃ¡m</th></tr>
    </thead>
    <tbody>
      <tr><td>ğŸŒ¿  SpontaneitÃ¡s</td><td><select></select></td><td><select></select></td><td><select></select></td><td><select></select></td><td><select></select></td><td class="score">0</td></tr>
      <tr><td>ğŸ§   Intelligencia / KreativitÃ¡s</td><td><select></select></td><td><select></select></td><td><select></select></td><td><select></select></td><td><select></select></td><td class="score">0</td></tr>
      <tr><td>ğŸ¤  EgyÃ¼ttmÅ±kÃ¶dÃ©s</td><td><select></select></td><td><select></select></td><td><select></select></td><td><select></select></td><td><select></select></td><td class="score">0</td></tr>
      <tr><td>ğŸ§˜â€â™€ï¸  KomfortzÃ³na rugalmassÃ¡ga</td><td><select></select></td><td><select></select></td><td><select></select></td><td><select></select></td><td><select></select></td><td class="score">0</td></tr>
      <tr><td>ğŸ”¥  KitartÃ¡s / StresszkezelÃ©s</td><td><select></select></td><td><select></select></td><td><select></select></td><td><select></select></td><td><select></select></td><td class="score">0</td></tr>
      <tr><td>ğŸ’¡  Ã–nreflexiÃ³</td><td><select></select></td><td><select></select></td><td><select></select></td><td><select></select></td><td><select></select></td><td class="score">0</td></tr>
      <tr><td>ğŸ’¬  Ã‰rzelmi intelligencia / SpiritualitÃ¡s</td><td><select></select></td><td><select></select></td><td><select></select></td><td><select></select></td><td><select></select></td><td class="score">0</td></tr>
      <tr><td>ğŸ˜Š  Hangulatom</td><td><select></select></td><td><select></select></td><td><select></select></td><td><select></select></td><td><select></select></td><td class="score">0</td></tr>
    </tbody>
  </table>

  <h2 data-emoji="â­">Fontos aspektusok</h2>
  <table id="importantAspects">
    <thead>
      <tr><th>Aspektus</th><th>Ã–sszesÃ­tett pont az 5. randi utÃ¡n</th></tr>
    </thead>
    <tbody>
      <tr><td>ğŸ­  Humor</td><td><select></select></td></tr>
      <tr><td>ğŸ§²  Fizikai vonzalom</td><td><select></select></td></tr>
      <tr><td>ğŸ§©  KapcsolÃ³dÃ¡si kÃ¶nnyedsÃ©g</td><td><select></select></td></tr>
      <tr><td>ğŸ‘•  Ã–ltÃ¶zkÃ¶dÃ©s</td><td><select></select></td></tr>
      <tr><td>ğŸ§  Zenei Ã­zlÃ©s</td><td><select></select></td></tr>
      <tr><td>ğŸ§¼  HigiÃ©nia</td><td><select></select></td></tr>
      <tr><td>ğŸ«¦  SzexualitÃ¡s</td><td><select></select></td></tr>
      <tr><td>ğŸŒˆ  SokszÃ­nÅ±sÃ©g (EgyÃ©b tulajdonsÃ¡gok)</td><td id="diversityTotal">0</td></tr>
    </tbody>
  </table>

  <h2 data-emoji="ğŸŒŸ">EgyÃ©b tulajdonsÃ¡gok</h2>
  <table id="otherProps">
    <thead><tr><th>TulajdonsÃ¡g</th><th>Pont</th></tr></thead>
    <tbody>
      <tr><td>AmbÃ­ciÃ³zussÃ¡g / SzenvedÃ©lyessÃ©g</td><td><select></select></td></tr>
      <tr><td>AutentikussÃ¡g</td><td><select></select></td></tr>
      <tr><td>BÃ¡torsÃ¡g</td><td><select></select></td></tr>
      <tr><td>BÃ¶lcsessÃ©g</td><td><select></select></td></tr>
      <tr><td>CsalÃ¡d-kÃ¶zpontÃºsÃ¡g</td><td><select></select></td></tr>
      <tr><td>EnergikussÃ¡g</td><td><select></select></td></tr>
      <tr><td>KalandvÃ¡gyÃ¡s / KihÃ­vÃ¡skedvelÃ©s</td><td><select></select></td></tr>
      <tr><td>KedvessÃ©g / SzelÃ­dsÃ©g</td><td><select></select></td></tr>
      <tr><td>NyugodtsÃ¡g</td><td><select></select></td></tr>
      <tr><td>Ã–nÃ¡llÃ³sÃ¡g</td><td><select></select></td></tr>
      <tr><td>ÅszintesÃ©g / HÅ±sÃ©gessÃ©g</td><td><select></select></td></tr>
      <tr><td>SzerÃ©nysÃ©g</td><td><select></select></td></tr>
      <tr><td>UdvariassÃ¡g</td><td><select></select></td></tr>
      <tr><td><strong>TulajdonsÃ¡gok Ã¶sszesÃ­tett pontszÃ¡ma</strong></td><td id="otherPropsTotal">0</td></tr>
    </tbody>
  </table>

  <h2 data-emoji="âœ¨">EgyÃ©ni tulajdonsÃ¡gok</h2>
  <table id="customProps">
    <thead><tr><th>TulajdonsÃ¡g neve</th><th>Pont (+/-)</th></tr></thead>
    <tbody>
      <tr><td><input type="text" class="custom-name" placeholder="TulajdonsÃ¡g neve..."></td><td><input type="number" class="custom-score" value="0" min="-99" max="99"></td></tr>
      <tr><td><input type="text" class="custom-name" placeholder="TulajdonsÃ¡g neve..."></td><td><input type="number" class="custom-score" value="0" min="-99" max="99"></td></tr>
      <tr><td><input type="text" class="custom-name" placeholder="TulajdonsÃ¡g neve..."></td><td><input type="number" class="custom-score" value="0" min="-99" max="99"></td></tr>
      <tr><td><input type="text" class="custom-name" placeholder="TulajdonsÃ¡g neve..."></td><td><input type="number" class="custom-score" value="0" min="-99" max="99"></td></tr>
      <tr><td><input type="text" class="custom-name" placeholder="TulajdonsÃ¡g neve..."></td><td><input type="number" class="custom-score" value="0" min="-99" max="99"></td></tr>
      <tr><td><input type="text" class="custom-name" placeholder="TulajdonsÃ¡g neve..."></td><td><input type="number" class="custom-score" value="0" min="-99" max="99"></td></tr>
      <tr><td><input type="text" class="custom-name" placeholder="TulajdonsÃ¡g neve..."></td><td><input type="number" class="custom-score" value="0" min="-99" max="99"></td></tr>
      <tr><td><input type="text" class="custom-name" placeholder="TulajdonsÃ¡g neve..."></td><td><input type="number" class="custom-score" value="0" min="-99" max="99"></td></tr>
      <tr><td><input type="text" class="custom-name" placeholder="TulajdonsÃ¡g neve..."></td><td><input type="number" class="custom-score" value="0" min="-99" max="99"></td></tr>
      <tr><td><input type="text" class="custom-name" placeholder="TulajdonsÃ¡g neve..."></td><td><input type="number" class="custom-score" value="0" min="-99" max="99"></td></tr>
      <tr><td><strong>PontszÃ¡m Ã¶sszesen</strong></td><td id="customPropsTotal">0</td></tr>
    </tbody>
  </table>

  <h2 data-emoji="ğŸ“Š">Ã–sszegzÃ©s</h2>
  <table id="summary">
    <tbody>
      <tr><td>Ã‰rtÃ©kelt mezÅ‘k szÃ¡ma</td><td id="filledCount">0 db</td></tr>
      <tr><td>ElÃ©rhetÅ‘ max pontszÃ¡m</td><td id="maxScore">0 pont</td></tr>
      <tr><td>ElÃ©rt pontszÃ¡m</td><td id="achievedScore">0 pont</td></tr>
      <tr><td>IlleszkedÃ©si arÃ¡ny</td><td id="fitRatio">0,00%</td></tr>
    </tbody>
  </table>

  <h2 data-emoji="ğŸ“–">Ã‰rtelmezÃ©s</h2>
  <table>
    <tbody>
      <tr><td>90â€“100%</td><td>ğŸŸ©  KivÃ©teles illeszkedÃ©s</td></tr>
      <tr><td>70â€“89%</td><td>ğŸŸ¦  ErÅ‘s kompatibilitÃ¡s</td></tr>
      <tr><td>40â€“69%</td><td>ğŸŸ¨  RÃ©szleges kompatibilitÃ¡s</td></tr>
      <tr><td>20â€“39%</td><td>ğŸŸ§  FigyelmeztetÅ‘ zÃ³na</td></tr>
      <tr><td>0â€“19%</td><td>ğŸŸ¥  Alacsony illeszkedÃ©s</td></tr>
    </tbody>
  </table>

  <button class="btn" onclick="downloadJSON()">EredmÃ©ny letÃ¶ltÃ©se (JSON)</button>
  <input type="file" id="jsonUpload" accept="application/json" class="btn" />

  <a href="projects.html">
    <button class="back-button">Go back</button>
  </a>

  <footer>
    Ez egy statikus HTML oldal. Az adatok lenyÃ­lÃ³ listÃ¡kbÃ³l vÃ¡laszthatÃ³k. A letÃ¶ltÃ¶tt JSON tartalmazza az aktuÃ¡lis Ã¡llapotot, amit kÃ©sÅ‘bb vissza lehet tÃ¶lteni.
  </footer>
  
  
  









  <script>
    window.addEventListener('DOMContentLoaded', () => {
      // 1. FeltÃ¶ltjÃ¼k az Ã¶sszes selectet 1â€“5 opciÃ³kkal (+ Ã¼res)
      document.querySelectorAll('select').forEach(sel => {
        sel.innerHTML = '<option value="">-</option>' +
          Array.from({length:5}, (_,i)=>`<option value="${i+1}">${i+1}</option>`).join('');

        sel.addEventListener('change', updateAll);
      });

      // 2. MainAspects utolsÃ³ oszlop lÃ©trehozÃ¡sa (ha mÃ©g nincs span)
      document.querySelectorAll('#mainAspects tbody tr').forEach(tr=>{
        const lastTd = tr.querySelector('td.score');
        if(!lastTd) {
          const tds = tr.querySelectorAll('td');
          tds[tds.length-1].innerHTML = '<span class="score">0</span>';
        }
      });

      // 3. Custom properties event listeners
      document.querySelectorAll('#customProps .custom-score').forEach(input => {
        input.addEventListener('input', updateAll);
      });

      updateAll(); // indulÃ¡skor is frissÃ­t
    });
    











    function updateAll() {
  // ğŸ”¹ 1. FrissÃ­tjÃ¼k mainAspects pontszÃ¡m oszlopait
  document.querySelectorAll('#mainAspects tbody tr').forEach(tr=>{
    const selects = Array.from(tr.querySelectorAll('select')).slice(0,5);
    const scoreSpan = tr.querySelector('.score') || tr.querySelector('td:last-child');
    const sum = selects.reduce((acc, s) => acc + Number(s.value || 0), 0);
    if(scoreSpan) scoreSpan.textContent = sum;
  });

  // ğŸ”¹ 2. Ã–sszesÃ­tett Ã©rtÃ©kek csak mainAspects + importantAspects
  let totalSum = 0;
  let filled = 0;

  document.querySelectorAll('#mainAspects select, #importantAspects select').forEach(sel => {
    const v = parseInt(sel.value,10);
    if(!isNaN(v)){
      totalSum += v;
      filled++;
    }
  });

  // ğŸ”¹ 3. Ã–sszesÃ­tett pont az "EgyÃ©b tulajdonsÃ¡gok" tÃ¡blÃ¡zatbÃ³l
  let otherSum = 0;
  document.querySelectorAll('#otherProps tbody tr:not(:last-child) select').forEach(sel=>{
    const v = parseInt(sel.value,10);
    if(!isNaN(v)) otherSum += v;
  });
  document.getElementById('otherPropsTotal').textContent = otherSum;

  // ğŸ”¹ 4. DiversityScore az otherPropsTotal alapjÃ¡n
  const totalForDiversity = parseInt(document.getElementById('otherPropsTotal').textContent,10) || 0;
  let diversityScore = 0;
  if(totalForDiversity <= 10) diversityScore = 0;
  else if(totalForDiversity <= 20) diversityScore = 1;
  else if(totalForDiversity <= 30) diversityScore = 2;
  else if(totalForDiversity <= 40) diversityScore = 3;
  else if(totalForDiversity <= 50) diversityScore = 4;
  else if(totalForDiversity > 60) diversityScore = 5;

  document.getElementById('diversityTotal').textContent = diversityScore;

  // ğŸ”¹ 5. HozzÃ¡adjuk a diversityScore-t a totalSum-hoz
  totalSum += diversityScore;

  // ğŸ”¹ 6. Custom properties Ã¶sszesÃ­tÃ©se
  let customSum = 0;
  document.querySelectorAll('#customProps .custom-score').forEach(input => {
    const v = parseInt(input.value, 10);
    if (!isNaN(v)) customSum += v;
  });
  document.getElementById('customPropsTotal').textContent = customSum;

  // ğŸ”¹ 7. HozzÃ¡adjuk a custom pontokat a totalSum-hoz
  totalSum += customSum;

  // Ha van kitÃ¶ltÃ¶tt mezÅ‘, hozzÃ¡adjuk a diversityScore-t is
  const totalFilled = filled > 0 ? filled + 1 : 0; // +1 a diversityScore-Ã©rt, de csak ha van kitÃ¶ltÃ¶tt mezÅ‘
  const maxScore = filled > 0 ? filled * 5 + 5 : 0; // +5 a diversityScore max, de csak ha van kitÃ¶ltÃ¶tt mezÅ‘
  const fitRatio = maxScore > 0 ? ((totalSum / maxScore) * 100).toFixed(2) : '0.00';

  document.getElementById('filledCount').textContent = totalFilled + ' db';
  document.getElementById('maxScore').textContent = maxScore + ' pont';
  document.getElementById('achievedScore').textContent = totalSum + ' pont';
  document.getElementById('fitRatio').textContent = fitRatio + '%';
}

// minden select vÃ¡ltozÃ¡skor frissÃ­tÃ¼nk
document.querySelectorAll('select').forEach(sel=>{
  sel.addEventListener('change', updateAll);
});

// custom score inputok vÃ¡ltozÃ¡skor frissÃ­tÃ¼nk
document.querySelectorAll('#customProps .custom-score').forEach(input => {
  input.addEventListener('input', updateAll);
  input.addEventListener('change', updateAll);
});

// indulÃ¡skor is frissÃ­tjÃ¼k
updateAll();










    document.querySelectorAll('#otherProps select').forEach(sel => {
      sel.innerHTML = '<option value="">-</option>' + 
                    Array.from({length:5}, (_,i)=>`<option value="${i+1}">${i+1}</option>`).join('');
      sel.addEventListener('change', updateOtherPropsTotal);
    });

    function updateOtherPropsTotal() {
      let sum = 0;
      document.querySelectorAll('#otherProps tbody tr:not(:last-child) select').forEach(sel => {
      const v = parseInt(sel.value,10);
      if(!isNaN(v)) sum += v;
      });
      document.getElementById('otherPropsTotal').textContent = sum;
    }

    // indulÃ¡skor is frissÃ­tjÃ¼k
    updateOtherPropsTotal();
















    // ğŸ”¹ JSON letÃ¶ltÃ©s Ã©s feltÃ¶ltÃ©s
    function tableToArray(tableId){
      const rows = document.querySelectorAll(`#${tableId} tbody tr`);
      return Array.from(rows).map(r=> Array.from(r.querySelectorAll('td')).map(td=>{
        const sel = td.querySelector('select');
        return sel ? sel.value : td.innerText.trim();
      }));
    }
    
    function getCustomProps() {
      const rows = document.querySelectorAll('#customProps tbody tr:not(:last-child)');
      return Array.from(rows).map(tr => {
        const nameInput = tr.querySelector('.custom-name');
        const scoreInput = tr.querySelector('.custom-score');
        return {
          name: nameInput ? nameInput.value : '',
          score: scoreInput ? parseInt(scoreInput.value, 10) || 0 : 0
        };
      });
    }

    function downloadJSON(){
      const data = {
        mainAspects: tableToArray('mainAspects'),
        importantAspects: tableToArray('importantAspects'),
        otherProps: tableToArray('otherProps'),
        customProps: getCustomProps()
      };
      const blob = new Blob([JSON.stringify(data,null,2)], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href=url; a.download='love-trial.json'; a.click();
      URL.revokeObjectURL(url);
    }
    
    document.getElementById('jsonUpload').addEventListener('change', function(){
      const file = this.files[0];
      if(!file) return;
      const reader = new FileReader();
      reader.onload = e => {
        try{
          const data = JSON.parse(e.target.result);
          function fillTable(tableId, arr){
            const rows = document.querySelectorAll(`#${tableId} tbody tr`);
            arr.forEach((row,i)=>{
              if(rows[i]){
                const cells = rows[i].querySelectorAll('td');
                row.forEach((val,j)=>{
                  if(cells[j]){
                    const sel = cells[j].querySelector('select');
                    if(sel){ sel.value = val; } else { cells[j].innerText = val; }
                  }
                });
              }
            });
          }
          fillTable('mainAspects', data.mainAspects||[]);
          fillTable('importantAspects', data.importantAspects||[]);
          fillTable('otherProps', data.otherProps||[]);

          // Load custom properties
          if (data.customProps && Array.isArray(data.customProps)) {
            const rows = document.querySelectorAll('#customProps tbody tr:not(:last-child)');
            data.customProps.forEach((item, i) => {
              if (rows[i]) {
                const nameInput = rows[i].querySelector('.custom-name');
                const scoreInput = rows[i].querySelector('.custom-score');
                if (nameInput) nameInput.value = item.name || '';
                if (scoreInput) scoreInput.value = item.score || 0;
              }
            });
          }

          updateAll(); // frissÃ­tjÃ¼k a szÃ¡mÃ­tÃ¡sokat a betÃ¶ltÃ¶tt adatokkal
        }catch(err){
          alert('HibÃ¡s JSON fÃ¡jl.');
        }
      };
      reader.readAsText(file);
    });
  </script>
    
</div>
</body>

</html>
